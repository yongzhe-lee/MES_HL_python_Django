/**
 * Kendo UI v2024.2.514 (http://www.telerik.com/kendo-ui)
 * Copyright 2024 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("kendo.core.js"),require("kendo.progressbar.js"),require("kendo.icons.js"),require("kendo.html.button.js")):"function"==typeof define&&define.amd?define(["kendo.core.min","kendo.progressbar.min","kendo.icons.min","kendo.html.button.min"],t):((e="undefined"!=typeof globalThis?globalThis:e||self).kendoupload=e.kendoupload||{},e.kendoupload.js=t())}(this,(function(){return function(e,t){var a=window.kendo,n=a.ui.Widget,i=a.antiForgeryTokens,o=a.logToConsole,r=/\.([^\.]+)$/,s=".kendoUpload",l="select",d="upload",p="success",u="error",c="complete",f="cancel",h="clear",m="pause",k="resume",v="progress",g="remove",_="validationErrors",y="invalidMaxFileSize",F="invalidMinFileSize",w="invalidFileExtension",C="k-hover",b="k-focus",E="k-progressbar",S="."+E,U="tabindex",z="upload",x="exclamation-circle",A="check",D=n.extend({init:function(e,t){var i=this;i.progressbars=[],n.fn.init.call(i,e,t),i.name=e.name,i.multiple=i.options.multiple,i.directory=i.options.directory,i.localization=i.options.localization;var o=i.element;i.wrapper=o.closest(".k-upload"),0===i.wrapper.length&&(i.wrapper=i._wrapInput(o)),i._activeInput(o),i.element.addClass("k-hidden"),i.toggle(i.options.enabled);var r=i._ns=s+"-"+a.guid();o.closest("form").on("submit"+r,i._onParentFormSubmit.bind(i)).on("reset"+r,i._onParentFormReset.bind(i)),i._initUploadModule(),i._toggleDropZone(),i.wrapper.on("keydown",".k-upload-button",i._onUploadButtonKeydown.bind(i)).on("click",".k-upload-action",i._onFileAction.bind(i)).on("click",".k-clear-selected",i._onClearSelected.bind(i)).on("click",".k-upload-button",(function(e){e.preventDefault(),i.element.click()})).on("click",".k-upload-selected",i._onUploadSelected.bind(i)).on("keydown",i._onKeyDown.bind(i)).on("focusout",i._focusout.bind(i)),i.element.val()&&i._onInputChange({target:i.element})},events:[l,d,p,u,c,f,h,v,g,m,k],options:{name:"Upload",enabled:!0,multiple:!0,directory:!1,showFileList:!0,template:"",files:[],async:{autoRetryAfter:0,bufferChunkSize:1e7,maxAutoRetries:1,removeVerb:"POST",autoUpload:!0,withCredentials:!0,accept:"*/*; q=0.5, application/json",useArrayBuffer:!1},localization:{select:"Select files...",cancel:"Cancel",retry:"Retry",remove:"Remove",pause:"Pause",resume:"Resume",clearSelectedFiles:"Clear",uploadSelectedFiles:"Upload",dropFilesHere:"Drop files here to upload",invalidFiles:"Invalid file(s). Please check file upload requirements.",statusUploading:"uploading",statusUploaded:"uploaded",statusWarning:"warning",statusFailed:"failed",headerStatusUploading:"Uploading...",headerStatusPaused:"Paused",headerStatusUploaded:"Done",uploadSuccess:"File(s) uploaded successfully.",uploadFail:"File(s) failed to upload.",invalidMaxFileSize:"File size too large.",invalidMinFileSize:"File size too small.",invalidFileExtension:"File type not allowed."},validation:{allowedExtensions:[],maxFileSize:0,minFileSize:0},dropZone:""},_initUploadModule:function(){var e=this,t=e.options;if(t.async.saveUrl){e._module=e._supportsFormData()?new T(e):new P(e),e._async=!0;var a=t.files;a.length>0&&e._renderInitialFiles(a)}else e._module=new R(e)},setOptions:function(t){var a=this,i=a.element;e(a.options.dropZone).off(a._ns),n.fn.setOptions.call(a,t),a.multiple=a.options.multiple,a.directory=a.options.directory,i.attr("multiple",!!a._supportsMultiple()&&a.multiple),a.directory&&(i.attr("webkitdirectory",a.directory),i.attr("directory",a.directory)),a.toggle(a.options.enabled),a._initUploadModule(),a._toggleDropZone()},enable:function(e){e=void 0===e||e,this.toggle(e)},disable:function(){this.toggle(!1)},toggle:function(e){e=void 0===e?e:!e,this.wrapper.toggleClass("k-disabled",e),this.element.prop("disabled",e)},focus:function(){this.wrapper.find(".k-upload-button").trigger("focus")},destroy:function(){var t=this,a=e(t.options.dropZone);e(document).add(e(".k-dropzone",t.wrapper)).add(t.wrapper.closest("form")).off(t._ns),a.length>0&&a.off(t._ns),e(t.element).off(s),t.progressbars&&t.progressbars.forEach((e=>{e.destroy()})),n.fn.destroy.call(t)},pause:function(t){this._module.onPause({target:e(t,this.wrapper)});var n=t.find(".k-i-pause-sm,.k-svg-i-pause-sm"),i=a.htmlEncode(this.localization.resume);a.ui.icon(n,{icon:"play-sm"}),n.attr("title",i),e(n).parent().attr("aria-label",i)},resume:function(t){this._module.onResume({target:e(t,this.wrapper)});var n=t.find(".k-i-play-sm,.k-svg-i-play-sm"),i=a.htmlEncode(this.localization.pause);a.ui.icon(n,{icon:"pause-sm"}),n.attr("title",i),e(n).parent().attr("aria-label",i)},upload:function(){this._module.onSaveSelected()},getFiles:function(){for(var t,a=[],n=this.wrapper.find(".k-file"),i=0;i<n.length;i++)if(t=e(n[i]).data("fileNames"))for(var o=0;o<t.length;o++)a.push(t[o]);return a},clearAllFiles:function(){var e=this;e.wrapper.find(".k-file").each((function(t,a){e._removeFileByDomElement(a,!1)}))},removeAllFiles:function(){var e=this;e.wrapper.find(".k-file").each((function(t,a){e._removeFileByDomElement(a,!0)}))},removeFileByUid:function(e){this._removeFileByUid(e,!0)},clearFileByUid:function(e){this._removeFileByUid(e,!1)},_removeFileByUid:function(t,n){var i;"string"==typeof t&&(i=e(".k-file["+a.attr("uid")+'="'+t+'"]',this.wrapper)).length>0&&this._removeFileByDomElement(i,n)},clearFile:function(e){this._removeFile(e,!1)},removeFile:function(e){this._removeFile(e,!0)},_removeFile:function(t,a){var n,i=this,o=i.wrapper.find(".k-file");"function"==typeof t&&o.each((function(o,r){n=e(r).data("fileNames"),t(n)&&i._removeFileByDomElement(r,a)}))},_removeFileByDomElement:function(t,a){var n=this,i={target:e(t,n.wrapper)};n.options.async.saveUrl?(e(t).hasClass("k-file-progress")?n._module.onCancel(i):n._module.onRemove(i,{},a),0===e(".k-file",n.wrapper).length?n._hideHeaderUploadstatus():n._updateHeaderUploadStatus()):n._module.onRemove(i,{},a)},_addInput:function(t){if(t[0].nodeType){var a=this,n=t.clone().val("");n.insertAfter(a.element).data("kendo"+a.options.prefix+a.options.name,a),e(a.element).attr(U,"-1").removeAttr("id").off(s),a._activeInput(n),a.wrapper.find(".k-upload-button").trigger("focus")}},_activeInput:function(e){var t=this,a=t.wrapper;t.element=e,t.directory&&(e.attr("webkitdirectory",t.directory),e.attr("directory",t.directory)),e.attr("multiple",!!t._supportsMultiple()&&t.multiple).attr("autocomplete","off").on("click"+s,(function(e){a.hasClass("k-disabled")&&e.preventDefault()})).on("change"+s,t._onInputChange.bind(t))},_adjustFocusState:function(e,t){e.removeClass(b),e.attr(U,-1),t.addClass(b),t.attr(U,0)},_arrowKeyNavigation:function(e,t,n){var i,o=this,r=a.keys;t===r.DOWN?(e.preventDefault(),e.stopPropagation(),i=o.wrapper.find(".k-upload-files .k-file").first(),n.length>0&&(n.hasClass("k-upload-action")&&(n.removeClass(b),n=n.closest(".k-file")),i=n.next()),o._adjustFocusState(n,i),i&&0!==i.length||(i=o.wrapper.find(".k-clear-selected"))):t===r.UP?(e.preventDefault(),e.stopPropagation(),i=o.wrapper.find(".k-upload-files .k-file:last"),n.length>0&&(n.hasClass("k-upload-action")&&(n.removeClass(b),n=n.closest(".k-file")),i=n.prev()),o._adjustFocusState(n,i)):t===r.RIGHT?(n.hasClass("k-upload-action")?(i=n.next(".k-upload-action"))&&0!==i.length||(i=n.parent().find(".k-upload-action:first")):n.length>0&&(i=n.find(".k-upload-action:first")),i&&i.length>0&&(n.removeClass(b),i.addClass(b))):t===r.LEFT&&(n.hasClass("k-upload-action")?(i=n.prev(".k-upload-action"))&&0!==i.length||(i=n.parent().find(".k-upload-action:last")):n.length>0&&(i=n.find(".k-upload-action:last")),i&&i.length>0&&(n.removeClass(b),i.addClass(b))),i&&0!==i.length||t!==r.UP&&t!==r.DOWN||(i=o.wrapper.find(".k-upload-button")),i&&i.length>0&&(o._preventFocusRemove=!0,i.trigger("focus"))},_asyncCommandKeyNavigation:function(t,n,i){var o=this,r=a.keys,s=e(n,o.wrapper);if(o._retryClicked=!1,t===r.ESC&&n.find(".k-i-cancel,.k-svg-i-cancel").length>0)o.trigger(f,i),o._module.onCancel({target:s}),o._checkAllComplete(),o._updateHeaderUploadStatus(),o._preventFocusRemove=!0,o.wrapper.find(".k-upload-button").trigger("focus");else if(t===r.SPACEBAR)n.find(".k-i-pause-sm,.k-svg-i-pause-sm").length>0?(o.trigger(m,i),o.pause(n),o._updateHeaderUploadStatus()):n.find(".k-i-play-sm,.k-svg-i-play-sm").length>0&&(o.trigger(k,i),o.resume(n));else if(t===r.ENTER&&!n.is(".k-file-progress, .k-file-success, .k-file-invalid")){if(o.options.async.chunkSize&&!o.options.async.concurrent&&e(".k-file-progress",o.wrapper).length>0)return;e(".k-i-exclamation-circle,.k-svg-i-exclamation-circle",n).remove(),e(S,n).finish().show(),o._module.metaData[s.data("uid")]||o._module.prepareChunk(s),o._module.onRetry({target:s}),o._retryClicked=!0}},_commandKeyNavigation:function(t,n){var i=this,o=a.keys,r=n.data("fileNames"),s=i._filesContainValidationErrors(r),l={files:r,headers:{}};t===o.DELETE?i.trigger(g,l)||(i._module.onRemove({target:e(n,i.wrapper)},l,!s),i._preventFocusRemove=!0,i.wrapper.find(".k-upload-button").trigger("focus")):t===o.TAB?(n.removeClass(b),n.attr(U,-1)):i.options.async.saveUrl&&i._asyncCommandKeyNavigation(t,n,l)},_focusout:function(){var e=this.wrapper.find(".k-upload-files .k-file."+b);this._preventFocusRemove?this._preventFocusRemove=!1:(e.removeClass(b),e.attr(U,-1))},_onKeyDown:function(e){var t=this,n=t.wrapper.find(".k-upload-files .k-file."+b+",.k-upload-action."+b),i=a.keys,o=[i.DELETE,i.ESC,i.ENTER,i.SPACEBAR,i.TAB],r=e.keyCode;r===i.DOWN||r===i.UP||r===i.LEFT||r===i.RIGHT?t._arrowKeyNavigation(e,r,n):n.length>0&&n.hasClass("k-file")&&o.indexOf(r)>-1&&!t.wrapper.hasClass("k-disabled")&&(r===i.SPACEBAR&&(e.preventDefault(),e.stopPropagation()),t._commandKeyNavigation(r,n))},_onInputChange:function(t){var a=this,n=e(t.target),i=q(a._inputFiles(n),a._isAsyncNonBatch());M(i,a.options.validation),a.trigger(l,{files:i})?(a._addInput(n),n.remove()):a._module.onSelect({target:n},i),a.focus()},_onUploadButtonKeydown:function(e){var t=e.keyCode,n=a.keys;t!==n.ENTER&&t!==n.SPACEBAR||this.wrapper.find(".k-upload-button-wrap input").last().trigger("click")},_readDirectory:function(t){var a=new e.Deferred,n=t.createReader(),i=[],o=function(){n.readEntries((function(e){e.length?(i=i.concat(e),o()):a.resolve(i)}),a.reject)};return o(),a.promise()},_readFile:function(e){var t=this,a=e.fullPath;e.file((function(e){e.relativePath=a.slice(1),t.droppedFolderFiles.push(e),t.droppedFolderCounter--,0===t.droppedFolderCounter&&setTimeout((function(){0===t.droppedFolderCounter&&t.droppedFolderFiles.length&&(t._proceedDroppedItems(t.droppedFolderFiles),t.droppedFolderFiles=[])}),0)}),(function(){o("File error.")}))},_traverseFileTree:function(e,t){var a=this;t||a.droppedFolderCounter--,this._readDirectory(e).then((function(e){a.droppedFolderCounter+=e.length;for(var t=0;t<e.length;t++)e[t].isFile?a._readFile(e[t]):e[t].isDirectory&&a._traverseFileTree(e[t])}))},_onDrop:function(e){var t,a=e.originalEvent.dataTransfer,n=this,i=a.files;if($(e),n.options.directoryDrop&&a.items){t=a.items.length,n.droppedFolderCounter=0,n.droppedFolderFiles=[];for(var o=0;o<t;o++)if(a.items[o].webkitGetAsEntry){var r=a.items[o].webkitGetAsEntry();r.isDirectory?n._traverseFileTree(r,!0):r.isFile&&n.droppedFolderFiles.push(a.files[o])}else n._proceedDroppedItems(i)}else n._proceedDroppedItems(i)},_proceedDroppedItems:function(t){var a=this,n=q(N(t),a._isAsyncNonBatch());t.length>0&&!a.wrapper.hasClass("k-disabled")&&(!a.multiple&&n.length>1&&n.splice(1,n.length-1),M(n,a.options.validation),a.trigger(l,{files:n})||a._module.onSelect({target:e(".k-dropzone",a.wrapper)},n))},_filesContainValidationErrors:function(t){var a=!1;return e(t).each((function(e,t){if(t[_]&&t[_].length>0)return a=!0,!1})),a},_isAsyncNonBatch:function(){return this._async&&!this.options.async.batch||!1},_renderInitialFiles:function(e){var t=this,a=0;for(e=q(e,!0),a=0;a<e.length;a++){var n=e[a],i=t._enqueueFile(n.name,{fileNames:[n]});i.addClass("k-file-success").data("files",[e[a]]),t._supportsRemove()&&t._fileAction(i,g)}},_prepareTemplateData:function(e,t){var a=t.fileNames,n={},i=0,o=0;for(o=0;o<a.length;o++)i+=a[o].size;return n.name=e,n.size=i,n.files=t.fileNames,n},_createProgressbarWapper:function(){return"<div class='"+E+" k-hidden'></div>"},_createFileIconWrapper:function(e){return"<span class='k-file-icon-wrapper'>"+a.ui.icon({icon:e,iconClass:"k-file-icon",size:"xxlarge"})+"<span class='k-file-state'></span></span>"},_progressbarInit:function(e){let t=e.kendoProgressBar({animation:!1,showStatus:!1}).data("kendoProgressBar");this.progressbars.push(t)},_prepareDefaultSingleFileEntryTemplate:function(t){var n=t.fileNames[0],i=O(t.fileNames),o=a.getFileGroup(n.extension,!0),r=n[_],s=r&&r.length>0,l=s?" k-file-invalid k-file-error":"",d=s?"<span class='k-file-validation-message' aria-live='polite'>"+a.htmlEncode(this.localization[r[0]])+"</span>":"<span class='k-file-size'>"+i+"</span>",p="";return p+="<li class='k-file"+l+"'><div class='k-file-single'>"+this._createProgressbarWapper()+this._createFileIconWrapper(o)+"<span class='k-file-info'><span class='k-file-name' title='"+n.name+"'>"+n.name+"</span>"+d+"</span>",e(p+="<span class='k-upload-actions'></span></div>")},_prepareDefaultMultipleFileEntriesTemplate:function(t){var n,i,o=t.fileNames,r=this._filesContainValidationErrors(o),s=O(o),l="";for(l+="<li class='k-file"+(r?" k-file-invalid k-file-error":"")+"'><div class='k-file-multiple'>"+this._createProgressbarWapper()+this._createFileIconWrapper("copy"),o.sort((function(e,t){return e[_]?-1:t[_]?1:0})),l+="<span class='k-multiple-files-wrapper'>",n=0;n<o.length;n++){var d=O([i=o[n]]);l+="<span class='k-file-info'>",i[_]&&i[_].length>0?l+="<span class='k-file-name k-file-name-invalid' title='"+i.name+"'>"+i.name+"</span>":l+="<span class='k-file-name' title='"+i.name+"'>"+i.name+"</span>",l+="<span class='k-file-size'>"+d+"</span></span>"}return l+=r?"<span class='k-file-validation-message' aria-live='polite'>"+a.htmlEncode(this.localization.invalidFiles)+"</span>":"<span class='k-file-summary'>Total: "+o.length+" files, "+s+"</span>",e(l+="</span><span class='k-upload-actions'></span></div>")},_enqueueFile:function(t,n){var i,o,r,s,l,d,p=this,u=n.fileNames[0].uid,c=e(".k-upload-files",p.wrapper),f=p.options.template,h=f?".k-progress":S;return 0===c.length&&(c=e("<ul class='k-upload-files'></ul>").appendTo(p.wrapper),p.options.showFileList||c.hide(),p.wrapper.removeClass("k-upload-empty")),i=e(".k-file",c),f?(r=p._prepareTemplateData(t,n),f=a.template(f),(o=e("<li class='k-file'>"+f(r)+"</li>")).find(".k-upload-action").addClass("k-button k-icon-button k-button-md k-rounded-md k-button-flat k-button-flat-base")):o=1===n.fileNames.length?p._prepareDefaultSingleFileEntryTemplate(n):p._prepareDefaultMultipleFileEntriesTemplate(n),(d=(l=e(h,o[0])).length>0)&&p._progressbarInit(l),o.attr(a.attr("uid"),u).appendTo(c).data(n),!p._async&&d&&l.data("kendoProgressBar").value(100),!p.multiple&&i.length>0&&(s={files:i.data("fileNames"),headers:{}},p.trigger(g,s)||p._module.onRemove({target:e(i,p.wrapper)},s)),o},_removeFileEntry:function(t){var a,n=this,i=t.closest(".k-upload-files");t.remove(),a=e(".k-file",i),e(".k-file-success, .k-file-error",i).length===a.length&&this._hideActionButtons(),0===a.length?(i.remove(),n.wrapper.addClass("k-upload-empty"),n._hideHeaderUploadstatus()):n._updateHeaderUploadStatus()},_fileAction:function(t,n,i){var o,r={remove:"x",cancel:"cancel",retry:"arrow-rotate-cw-small",pause:"pause-sm"};let s=a.htmlEncode(this.localization[n]);if(r.hasOwnProperty(n))if(i||this._clearFileAction(t),this.options.template)if((o=t.find(".k-upload-action").first()).find(".k-icon,.k-svg-icon").length){if(o.next(".k-upload-action").length){let t=a.ui.icon(e(`<span title="${s}" aria-label="${s}"></span>`),{icon:r[n],iconClass:"k-button-icon"+("retry"==n?" k-i-retry":"")});o.next(".k-upload-action").addClass("k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button").append(t).show()}}else{let t=a.ui.icon(e(`<span title="${s}" aria-label="${s}"></span>`),{icon:r[n],iconClass:"k-button-icon"+("retry"==n?" k-i-retry":"")});o.addClass("k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-icon-button").append(t).show()}else i||t.find(".k-upload-action").remove(),t.find(".k-upload-actions").append(this._renderAction(r[n],s,"retry"==n?"k-i-retry":""))},_fileState:function(t,n){var i=this.localization,o={uploading:{text:i.statusUploading},uploaded:{text:i.statusUploaded},failed:{text:i.statusFailed}}[n];o&&e("span.k-file-state",t).text(a.htmlEncode(o.text))},_renderAction:function(t,n,i){return""!==t?e("<button type='button' class='k-button k-icon-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-upload-action' aria-hidden='true' aria-label='"+n+"' tabindex='-1'>"+a.ui.icon(e(`<span title="${n}"></span>`),{icon:t,iconClass:"k-button-icon"+(i?` ${i}`:"")})+"</button>").on("focus",(function(){e(this).addClass(b)})).on("blur",(function(){e(this).removeClass(b)})):e("<button type='button' class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class=\"k-button-text\">"+n+"</span></button>")},_clearFileAction:function(t){e(".k-upload-action",t).empty().hide()},_onFileAction:function(t){var a=this;if(!a.wrapper.hasClass("k-disabled")){var n=e(t.target).closest(".k-upload-action"),i=n.find(".k-icon,.k-svg-icon"),o=n.closest(".k-file"),r=o.data("fileNames"),s=a._filesContainValidationErrors(r),l={files:r,headers:{}};a._retryClicked=!1,i.is(".k-i-x,.k-svg-i-x")?a.trigger(g,l)||(a._module.onRemove({target:e(o,a.wrapper)},l,!s),a.wrapper.find(".k-upload-button").trigger("focus")):i.is(".k-i-cancel,.k-svg-i-cancel")?(a.trigger(f,l),a._module.onCancel({target:e(o,a.wrapper)}),a._checkAllComplete(),a._updateHeaderUploadStatus(),a.wrapper.find(".k-upload-button").trigger("focus")):i.is(".k-i-pause-sm,.k-svg-i-pause-sm")?(a.trigger(m,l),a.pause(o),a._updateHeaderUploadStatus()):i.is(".k-i-play-sm,.k-svg-i-play-sm")?(a.trigger(k,l),a.resume(o)):i.hasClass("k-i-retry")&&(e(".k-i-exclamation-circle",o).remove(),e(S,o).finish().show(),a._module.onRetry({target:e(o,a.wrapper)}),a._retryClicked=!0),o.addClass(b)}return!1},_onUploadSelected:function(){return this.wrapper.hasClass("k-disabled")||this._module.onSaveSelected(),!1},_onClearSelected:function(){var e=this;return e.wrapper.hasClass("k-disabled")||e.trigger(h,{})||e.clearAllFiles(),!1},_onFileProgress:function(t,a){var n=e(S,t.target).data("kendoProgressBar");a>100&&(a=100),e(S,t.target).removeClass("k-hidden"),this.options.template||(0===e(".k-upload-pct",t.target).length&&e(".k-upload-actions",t.target).prepend("<span class='k-upload-pct'></span>"),100!==a?e(".k-upload-pct",t.target).text(a+"%"):e(".k-upload-pct",t.target).remove()),n&&n.value(a),this.trigger(v,{files:J(t).data("fileNames"),percentComplete:a})},_onUploadSuccess:function(e,t,n){var i=this,o=J(e),r=o.data("fileNames"),s=o.find(".k-file-summary"),l=o.find(".k-file-size");i.trigger(p,{files:o.data("fileNames"),response:t,operation:"upload",XMLHttpRequest:n})?i._setUploadErrorState(o):(i._fileState(o,"uploaded"),o.removeClass("k-file-progress").addClass("k-file-success"),s.length>0?s.addClass("k-hidden").after('<span class="k-file-validation-message" aria-live="polite">'+r.length+" "+a.htmlEncode(i.localization.uploadSuccess)+"</span>"):l.length>0&&l.addClass("k-hidden").after('<span class="k-file-validation-message" aria-live="polite">'+a.htmlEncode(i.localization.uploadSuccess)+"</span>"),i._updateHeaderUploadStatus(),i._supportsRemove()?i._fileAction(o,g):i._clearFileAction(o)),i._hideUploadProgress(o),i._checkAllComplete()},_onUploadError:function(e,t){var a=this,n=a._module,i=J(e),r=i.data("uid");a._setUploadErrorState(i),a.trigger(u,{operation:"upload",files:i.data("fileNames"),XMLHttpRequest:t}),o("Server response: "+t.responseText),a.options.async.chunkSize?n._decreasePosition&&n._decreasePosition(r):a._hideUploadProgress(i),a._checkAllComplete(),this.options.async.autoRetryAfter&&this._autoRetryAfter(i)},_autoRetryAfter:function(e){var t=this,a=this._module.retries;a&&(a[e.data("uid")]||(a[e.data("uid")]=1),a[e.data("uid")]<=this.options.async.maxAutoRetries&&(a[e.data("uid")]++,setTimeout((function(){t._module.performUpload(e)}),this.options.async.autoRetryAfter)))},_setUploadErrorState:function(t){var n,i=this,o=t.data("fileNames"),r=t.find(".k-file-summary"),s=t.find(".k-file-size");i._fileState(t,"failed"),t.removeClass("k-file-progress").addClass("k-file-error"),r.length>0?r.addClass("k-hidden").after('<span class="k-file-validation-message" aria-live="polite">'+o.length+" "+a.htmlEncode(i.localization.uploadFail)+"</span>"):s.length>0&&s.addClass("k-hidden").after('<span class="k-file-validation-message" aria-live="polite">'+a.htmlEncode(i.localization.uploadFail)+"</span>"),i._updateUploadProgress(t),(n=e(".k-upload-pct",t)).length>0&&n.remove(),this._updateHeaderUploadStatus(),this._fileAction(t,"retry"),this._fileAction(t,g,!0),i._retryClicked&&t.trigger("focus")},_updateUploadProgress:function(t){var a=this,n=e(S,t),i=n.length>0;if(!a.options.async.chunkSize&&i)n.data("kendoProgressBar").value(100);else{var o=t.data("uid");if(a._module.metaData){var r=a._module.metaData[o];if(r){var s=r.totalChunks?Math.round(r.chunkIndex/r.totalChunks*100):100;a._onFileProgress({target:e(t,a.wrapper)},s)}}}},_hideUploadProgress:function(t){e(S,t).delay(1e3).fadeOut(2e3,(function(){e(this).data("kendoProgressBar")&&e(this).data("kendoProgressBar").value(0)}))},_showActionButtons:function(){var t=this,n=e(".k-actions",t.wrapper),i=e(".k-upload-selected",t.wrapper),o=e(".k-clear-selected",t.wrapper);0===i.length&&(i=e(a.html.renderButton(`<button class='k-upload-selected'>${a.htmlEncode(this.localization.uploadSelectedFiles)}</button>`,{icon:"upload",themeColor:"primary"})),o=e(a.html.renderButton(`<button class='k-clear-selected'>${a.htmlEncode(this.localization.clearSelectedFiles)}</button>`,{icon:"x"}))),n.length||(n=e("<div />").addClass("k-actions").append(i,o)),this.wrapper.append(n)},_hideActionButtons:function(){e(".k-actions",this.wrapper).remove()},_showHeaderUploadStatus:function(t){var n=this,i=n.localization,o=e(".k-dropzone",n.wrapper),r=e(".k-upload-status",n.wrapper);0!==r.length&&r.remove(),e(".k-dropzone-hint",n.wrapper).addClass("k-hidden"),r='<span class="k-upload-status"><span class="k-icon"></span></span>',t?(r=e(r).append(a.htmlEncode(i.headerStatusUploading)),a.ui.icon(r.find(".k-icon,.k-svg-icon"),{icon:z})):(r=e(r).append(a.htmlEncode(i.headerStatusUploaded)),a.ui.icon(r.find(".k-icon,.k-svg-icon"),{icon:x})),o.length>0?o.append(r):e(".k-upload-button",n.wrapper).after(r)},_updateHeaderUploadStatus:function(){var t,n=this,i=e(".k-upload-status",this.wrapper),o=e(".k-file",n.wrapper).not(".k-file-success, .k-file-error"),r=e(".k-file-error",n.wrapper),s=e(".k-file",n.wrapper).find(".k-i-play-sm,.k-svg-i-play-sm");!s.length||s.length!==o.length&&n.options.async.concurrent?(0===o.length||r.length>0)&&(i=e(".k-upload-status",n.wrapper),(t=e(".k-icon,.k-svg-icon",i).removeClass()).length&&(a.ui.icon(t,{icon:0!==r.length?x:A}),i.html(t).append(a.htmlEncode(n.localization.headerStatusUploaded)))):(t=e(".k-icon,.k-svg-icon",i).removeClass()).length&&(a.ui.icon(t,{icon:"pause-sm"}),i.html(t).append(a.htmlEncode(n.localization.headerStatusPaused)))},_hideHeaderUploadstatus:function(){var t=this.options.dropZone;e(".k-upload-status",this.wrapper).remove(),""===t&&e(".k-dropzone-hint",this.wrapper).removeClass("k-hidden")},_onParentFormSubmit:function(){var t=this.element;if(void 0!==this._module.onAbort&&this._module.onAbort(),!t.value){var a=e(t);a.attr("disabled","disabled"),window.setTimeout((function(){a.prop("disabled",!1)}),0)}},_onParentFormReset:function(){e(".k-upload-files",this.wrapper).remove()},_supportsFormData:function(){return"undefined"!=typeof FormData},_supportsMultiple:function(){var e=this._userAgent().indexOf("Windows")>-1;return!(a.support.browser.opera||a.support.browser.safari&&e)},_supportsDrop:function(){var e=this._userAgent().toLowerCase();return!(!/chrome/.test(e)&&/safari/.test(e)&&/windows/.test(e))&&this._supportsFormData()&&this.options.async.saveUrl},_userAgent:function(){return navigator.userAgent},_setupDropZone:function(){var t=this,n=t._ns,i=e(".k-dropzone",t.wrapper).on("dragenter"+n,$).on("dragover"+n,(function(e){e.originalEvent&&(e.originalEvent.dataTransfer.dropEffect="copy"),e.preventDefault()})).on("drop"+n,t._onDrop.bind(t));i.find(".k-dropzone-hint").length||i.append(e("<span class='k-dropzone-hint'>"+a.htmlEncode(t.localization.dropFilesHere)+"</span>")),X(i,n,(function(){i.closest(".k-upload").hasClass("k-disabled")||i.addClass(C)}),(function(){i.removeClass(C)})),t._bindDocumentDragEventWrappers(i)},_setupCustomDropZone:function(){var t=this,n=e(t.options.dropZone);t.wrapper.find(".k-dropzone-hint").length?e(".k-dropzone-hint",t.wrapper).addClass("k-hidden"):e(".k-dropzone",t.wrapper).append(e("<span class='k-dropzone-hint k-hidden'>"+a.htmlEncode(t.localization.dropFilesHere)+"</span>"));var i=t._ns;n.on("dragenter"+i,$).on("dragover"+i,(function(e){e.originalEvent&&(e.originalEvent.dataTransfer.dropEffect="copy"),e.preventDefault()})).on("drop"+i,t._onDrop.bind(t)),X(n,i,(function(a){t.wrapper.hasClass("k-disabled")||(n.removeClass(C),n.addClass(C),e(a.target).addClass(C))}),(function(){n.removeClass(C)})),t._bindDocumentDragEventWrappers(n)},_bindDocumentDragEventWrappers:function(t){var a=this,n=a._ns;X(e(document),n,(function(){a.wrapper.hasClass("k-disabled")||(t.addClass("k-dropzone-active"),t.closest(".k-upload").removeClass("k-upload-empty"),t.find(".k-dropzone-hint").removeClass("k-hidden"))}),(function(){t.removeClass("k-dropzone-active"),t.find(".k-dropzone-hint").addClass("k-hidden"),0===e("li.k-file",t.closest(".k-upload")).length&&t.closest(".k-upload").addClass("k-upload-empty")}))},_toggleDropZone:function(){var t=this,a=t.options.dropZone;t._supportsDrop()&&(e(a).off(t._ns),e(".k-dropzone",t.wrapper).off(t._ns),""!==a?t._setupCustomDropZone():t._setupDropZone())},_supportsRemove:function(){return!!this.options.async.removeUrl},_submitRemove:function(t,a,n,o){var r=this.options.async.removeField||"fileNames",s=e.extend(a.data,i());s[r]=t,jQuery.ajax({type:this.options.async.removeVerb,dataType:"json",dataFilter:V,url:this.options.async.removeUrl,traditional:!0,data:s,headers:a.headers,success:n,error:o,xhrFields:{withCredentials:this.options.async.withCredentials}})},_wrapInput:function(t){var n=this.options,i=!!t.attr("id")&&e("[for='"+t.attr("id")+"']").length>0,o=a.htmlEncode(this.localization.select),r=e("<div class='k-button k-button-md k-rounded-md k-button-solid k-button-solid-base k-upload-button' tabindex='0' role='button'><span class='k-button-text'></span></div>");return r.find(".k-button-text").text(o),t.wrap("<div class='k-upload' role='application'><div class='k-dropzone k-upload-dropzone'><div class='k-upload-button-wrap'></div></div></div>"),r.prependTo(t.parent()),n.async.saveUrl?t.closest(".k-upload").addClass("k-upload-async"):t.closest(".k-upload").addClass("k-upload-sync"),t.closest(".k-upload").addClass("k-upload-empty"),i||t.attr("aria-label")||t.attr("aria-label",o),t.attr({tabindex:-1,"aria-hidden":!0}),t.closest(".k-upload")},_checkAllComplete:function(){0===e(".k-file.k-file-progress",this.wrapper).length&&this.trigger(c)},_inputFiles:function(e){return B(e)}}),R=function(e){this.name="syncUploadModule",this.element=e.wrapper,this.upload=e,this.element.closest("form").attr("enctype","multipart/form-data").attr("encoding","multipart/form-data")};R.prototype={onSelect:function(t,a){var n=this.upload,i=e(t.target),o=n._filesContainValidationErrors(a);n._addInput(i);var r={fileNames:a};o?i.remove():r.relatedInput=i;var s=n._enqueueFile(I(i),r);o&&n._hideUploadProgress(s),n._fileAction(s,g)},onRemove:function(e){var t=J(e),a=t.data("relatedInput");a&&a.remove(),this.upload._removeFileEntry(t)}};var P=function(e){this.name="iframeUploadModule",this.element=e.wrapper,this.upload=e,this.iframes=[]};D._frameId=0,P.prototype={onSelect:function(t,a){var n=this.upload,i=e(t.target),o=n._filesContainValidationErrors(a),r=this.prepareUpload(i,a,o);n.options.async.autoUpload?o?(n._fileAction(r,g),n._showHeaderUploadStatus(!1)):this.performUpload(r):(n._fileAction(r,g),o?n._updateHeaderUploadStatus():n._showActionButtons()),o&&n._hideUploadProgress(r)},prepareUpload:function(t,a,n){var i,o,r,s,l=this.upload,d=e(l.element),p=l.options.async.saveField||t.attr("name");return l._addInput(t),t.attr("name",p),n?(t.remove(),o={fileNames:a}):(r=this.createFrame(l.name+"_"+D._frameId++),this.registerFrame(r),s=this.createForm(l.options.async.saveUrl,r.attr("name")).append(d),o={frame:r,relatedInput:d,fileNames:a}),i=l._enqueueFile(I(t),o),r&&r.data({form:s,file:i}),i},performUpload:function(t){var a={files:t.data("fileNames")},n=t.data("frame"),o=this.upload,r=t.find(".k-file-validation-message"),s=t.find(".k-file-summary"),l=t.find(".k-file-size");if(o.trigger(d,a))o._removeFileEntry(n.data("file")),this.cleanupFrame(n),this.unregisterFrame(n);else{o._hideActionButtons(),o._showHeaderUploadStatus(!0),n.appendTo(document.body);var p=n.data("form").attr("action",o.options.async.saveUrl).appendTo(document.body);for(var u in a.data=e.extend({},a.data,i()),a.data){var c=p.find("input[name='"+u+"']");0===c.length&&(c=e("<input>",{type:"hidden",name:u}).prependTo(p)),c.val(a.data[u])}o._fileAction(t,f),o._fileState(t,"uploading"),e(t).removeClass("k-file-error").addClass("k-file-progress"),r.length>0&&r.remove(),s.length>0?s.removeClass("k-hidden"):l.length>0&&l.removeClass("k-hidden"),n.one("load",this.onIframeLoad.bind(this)),p[0].submit()}},onSaveSelected:function(){var t=this,a=t.upload;e(".k-file",this.element).each((function(){var n=e(this),i=G(n),o=a._filesContainValidationErrors(n.data("fileNames"));i||o||t.performUpload(n)}))},onIframeLoad:function(t){var a,n=e(t.target);try{a=n.contents().text()}catch(e){a="Error trying to get server response: "+e}this.processResponse(n,a)},processResponse:function(t,a){var n=t.data("file"),i=this,o={responseText:a};K(a,(function(a){e.extend(o,{statusText:"OK",status:"200"}),i.upload._onFileProgress({target:e(n,i.upload.wrapper)},100),i.upload._onUploadSuccess({target:e(n,i.upload.wrapper)},a,o),i.cleanupFrame(t),i.unregisterFrame(t)}),(function(){e.extend(o,{statusText:"error",status:"500"}),i.upload._onUploadError({target:e(n,i.upload.wrapper)},o)}))},onCancel:function(t){var a=e(t.target).data("frame");this.stopFrameSubmit(a),this.cleanupFrame(a),this.unregisterFrame(a),this.upload._removeFileEntry(a.data("file"))},onRetry:function(e){var t=J(e);this.performUpload(t)},onRemove:function(e,t,a){var n=this,i=n.upload,o=J(e),r=o.data("frame");r?(n.unregisterFrame(r),i._removeFileEntry(o),n.cleanupFrame(r)):o.hasClass("k-file-success")?Z(o,i,t,a):i._removeFileEntry(o)},onAbort:function(){var t=this.element,a=this;e.each(this.iframes,(function(){e("input",this.data("form")).appendTo(t),a.stopFrameSubmit(this[0]),this.data("form").remove(),this.remove()})),this.iframes=[]},createFrame:function(t){return e("<iframe name='"+t+"' id='"+t+"' />").hide()},createForm:function(t,a){return e("<form enctype='multipart/form-data' method='POST' action='"+t+"' target='"+a+"'/>")},stopFrameSubmit:function(e){void 0!==e.stop?e.stop():e.document&&e.document.execCommand("Stop")},registerFrame:function(e){this.iframes.push(e)},unregisterFrame:function(t){this.iframes=e.grep(this.iframes,(function(e){return e.attr("name")!=t.attr("name")}))},cleanupFrame:function(e){var t=e.data("form");e.data("file").data("frame",null),setTimeout((function(){t.remove(),e.remove()}),1)}};var T=function(e){this.name="formDataUploadModule",this.element=e.wrapper,this.upload=e,this.position={},this.metaData={},this.cancelled={},this.resume={},this.paused={},this.retries={}};function I(t){return e.map(B(t),(function(e){return e.name})).join(", ")}function B(e){var t,a,n=e[0];return n.files?N(n.files):[{name:(t=n.value,a=t.lastIndexOf("\\"),-1!=a?t.substr(a+1):t),extension:H(n.value),size:null}]}function N(t){return e.map(t,(function(e){return n=(t=e).name||t.fileName,{name:a.htmlEncode(n),extension:H(n),size:"number"==typeof t.size?t.size:t.fileSize,rawFile:t};var t,n}))}function H(e){var t=e.match(r);return t?t[0]:""}function q(t,n){var i=a.guid();return e.map(t,(function(e){return e.uid=n?a.guid():i,e}))}function M(t,a){for(var n=function(t){var a=e.map(t,(function(e){return("."===e.substring(0,1)?e:"."+e).toLowerCase()}));return a}(a.allowedExtensions),i=a.maxFileSize,o=a.minFileSize,r=0;r<t.length;r++)L(t[r],n),j(t[r],o,i)}function L(t,a){a.length>0&&a.indexOf(t.extension.toLowerCase())<0&&(t.validationErrors=t.validationErrors||[],-1===e.inArray(w,t.validationErrors)&&t.validationErrors.push(w))}function j(t,a,n){0!==a&&t.size<a&&(t.validationErrors=t.validationErrors||[],-1===e.inArray(F,t.validationErrors)&&t.validationErrors.push(F)),0!==n&&t.size>n&&(t.validationErrors=t.validationErrors||[],-1===e.inArray(y,t.validationErrors)&&t.validationErrors.push(y))}function O(e){var t=0;if("number"!=typeof e[0].size)return"";for(var a=0;a<e.length;a++)e[a].size&&(t+=e[a].size);return(t/=1024)<1024?t.toFixed(2)+" KB":(t/1024).toFixed(2)+" MB"}function W(t){return!t.multiple&&e(".k-file",t.wrapper).length>1}function Z(t,a,n,i){if(a._supportsRemove()){var r=t.data("fileNames"),s=e.map(r,(function(e){return e.name}));!1!==i?a._submitRemove(s,n,(function(e,n,i){a.trigger(p,{operation:"remove",files:r,response:e,XMLHttpRequest:i})||a._removeFileEntry(t)}),(function(e){W(a)&&a._removeFileEntry(t),a.trigger(u,{operation:"remove",files:r,XMLHttpRequest:e}),o("Server response: "+e.responseText)})):a._removeFileEntry(t)}else!W(a)&&i||a._removeFileEntry(t)}function K(e,t,a){var n=!1,i="";try{i=JSON.parse(V(e)),n=!0}catch(e){a()}n&&t(i)}function V(e){return void 0!==e&&""!==e||(e="{}"),e}function $(e){e.originalEvent&&(e.originalEvent.dataTransfer.dropEffect="copy"),e.stopPropagation(),e.preventDefault()}function X(e,t,a,n){var i,o;e.on("dragenter"+t,(function(e){a(e),o=new Date,i||(i=setInterval((function(){new Date-o>100&&(n(),clearInterval(i),i=null)}),100))})).on("dragover"+t,(function(){o=new Date}))}function G(e){return e.is(".k-file-progress, .k-file-success, .k-file-error:not(.k-file-invalid)")}function J(t){return e(t.target).closest(".k-file")}T.prototype={onSelect:function(t,a){var n,i,o=this.upload,r=this,s=e(t.target),l=this.prepareUpload(s,a);e.each(l,(function(t){n=o._filesContainValidationErrors(e(this.data("fileNames"))),o.options.async.autoUpload?n?(o._fileAction(this,g),o._showHeaderUploadStatus(!1)):o.options.async.chunkSize?(r.prepareChunk(this),i=this.prev(),(o.options.async.concurrent||0===t&&!i.length||0===t&&i.hasClass("k-file-success"))&&r.performUpload(this)):r.performUpload(this):(o._fileAction(this,g),n?o._updateHeaderUploadStatus():(o._showActionButtons(),this.addClass("k-toupload"))),n&&o._hideUploadProgress(this)}))},prepareUpload:function(t,a){var n=this.enqueueFiles(a);return t.is("input")&&(e.each(n,(function(){e(this).data("relatedInput",t)})),t.data("relatedFileEntries",n),this.upload._addInput(t)),n},enqueueFiles:function(t){var a,n,i,o,r=this.upload,s=t.length,l=[];if(!0===r.options.async.batch)a=e.map(t,(function(e){return e.name})).join(", "),(r.directory||r.options.directoryDrop)&&e(t).each((function(){(this.rawFile.webkitRelativePath||this.rawFile.relativePath)&&(this.name=this.rawFile.webkitRelativePath||this.rawFile.relativePath)})),(o=r._enqueueFile(a,{fileNames:t})).data("files",t),l.push(o);else for(n=0;n<s;n++)a=(i=t[n]).name,(r.directory||r.options.directoryDrop)&&(i.rawFile.webkitRelativePath||i.rawFile.relativePath)&&(i.name=i.rawFile.webkitRelativePath||i.rawFile.relativePath),(o=r._enqueueFile(a,{fileNames:[i]})).data("files",[i]),l.push(o);return l},performUpload:function(t){var a,n=this.upload,o=this.createFormData(),r=this.createXHR(),s={files:t.data("fileNames"),XMLHttpRequest:r},l=t.find(".k-file-validation-message"),p=t.find(".k-file-summary"),u=t.find(".k-file-size");if(n.trigger(d,s))this.removeFileEntry(t);else{if(0===t.find(".k-i-cancel,.k-svg-i-cancel").length&&(n.options.async.chunkSize&&n._fileAction(t,m),n._fileAction(t,f,n.options.async.chunkSize)),n.wrapper.find(".k-toupload").length||n._hideActionButtons(),n._showHeaderUploadStatus(!0),s.formData)o=s.formData;else{for(var c in s.data=e.extend({},s.data,i()),s.data)o.append(c,s.data[c]);(a=t.data("files"))&&this.populateFormData(o,a)}n._fileState(t,"uploading"),e(t).removeClass("k-file-error").addClass("k-file-progress"),l.length>0&&l.remove(),p.length>0?p.removeClass("k-hidden"):u.length>0&&u.removeClass("k-hidden"),n.options.async.useArrayBuffer&&window.FileReader?this._readFile(n.options.async.saveUrl,o,t,r):this.postFormData(n.options.async.saveUrl,o,t,r)}},_readFile:function(t,a,n,i){var o=this,r=o.upload,s=n.data("files")[0],l=new FileReader;l.onload=function(l){try{o.fileArrayBuffer?o.fileArrayBuffer=o._appendBuffer(o.fileArrayBuffer,l.target.result):o.fileArrayBuffer=l.target.result}catch(t){return void r._onUploadError({target:e(n,r.wrapper)},i)}o.position[s.uid]>s.size?(o.postFormData(r.options.async.saveUrl,o.fileArrayBuffer,n,i),o.fileArrayBuffer=null):o._readFile(t,a,n,i)},l.onerror=function(){r._onUploadError({target:e(n,r.wrapper)},i)},l.readAsArrayBuffer(o._getCurrentChunk(s.rawFile,s.uid))},_appendBuffer:function(e,t){var a=new Uint8Array(e.byteLength+t.byteLength);return a.set(new Uint8Array(e),0),a.set(new Uint8Array(t),e.byteLength),a.buffer},onSaveSelected:function(){var t=this,a=t.upload;e(".k-toupload",this.element).filter((function(){var t=e(this),n=G(t),i=a._filesContainValidationErrors(t.data("fileNames"));return!n&&!i})).each((function(n){var i=e(this),o=i.prev();i.removeClass("k-toupload"),a.options.async.chunkSize?(t.prepareChunk(i),(a.options.async.concurrent||0===n&&!o.length||0===n&&o.hasClass("k-file-success")||o.hasClass("k-file-error:not(k-file-invalid)"))&&t.performUpload(i)):t.performUpload(i)}))},onCancel:function(e){var t=J(e);this.upload.options.async.chunkSize&&(this.cancelled[t.data("uid")]=!0),this.stopUploadRequest(t),this.removeFileEntry(t)},onPause:function(e){var t=J(e).data("uid"),a=this.upload.options.async;a.chunkSize&&(this.retries[t]=a.maxAutoRetries+1,this.paused[t]=!0,this.resume[t]=!1)},onResume:function(e){var t=J(e),a=t.data("uid");this.upload.options.async.chunkSize&&(delete this.paused[a],this.resume[a]=!0,this.retries[t.data("uid")]=1,this._increaseChunkIndex(a),this.performUpload(t))},onRetry:function(e){var t=J(e),a=this.upload.options.async;a.chunkSize&&(this.retries[t.data("uid")]=a.maxAutoRetries+1,delete this.paused[t.data("uid")]),this.performUpload(t)},onRemove:function(e,t,a){var n=this.upload,i=J(e),o=this.upload.options.async;o.chunkSize&&(this.retries[i.data("uid")]=o.maxAutoRetries+1),i.hasClass("k-file-success")?Z(i,n,t,a):this.removeFileEntry(i)},createXHR:function(){return new XMLHttpRequest},postFormData:function(e,t,a,n){var i=this;a.data("request",n),n.addEventListener("load",(function(e){i.onRequestSuccess.call(i,e,a)}),!1),n.addEventListener(u,(function(e){i.onRequestError.call(i,e,a)}),!1),n.upload.addEventListener("progress",(function(e){i.onRequestProgress.call(i,e,a)}),!1),n.open("POST",e,!0),n.withCredentials=this.upload.options.async.withCredentials;var o=this.upload.options.async.accept;o&&n.setRequestHeader("Accept",o),n.send(t)},createFormData:function(){return new FormData},populateFormData:function(e,t){var a,n,i,o=t.length,r=this.upload;if(r.options.async.chunkSize){i=t[0].uid,a=this._getCurrentChunk(t[0].rawFile,i),e.append(r.options.async.saveField||r.name,a);var s=JSON.stringify(this.metaData[i]);e.append("metadata",s)}else for(n=0;n<o;n++)e.append(r.options.async.saveField||r.name,t[n].rawFile);return e},onRequestSuccess:function(t,a){var n=t.target,i=this;function o(){i.upload._onUploadError({target:e(a,i.upload.wrapper)},n)}n.status>=200&&n.status<=299?K(n.responseText,(function(t){var o=i.upload.options.async.batch,r=i.upload.options.async.chunkSize,s=i.upload.options.async.concurrent,l=t.fileUid;i.paused[l]||i.cancelled[l]||(delete i.retries[l],!r||o||t.uploaded?!r||o||s||!a.next().length||a.next().hasClass("k-toupload")?(i.upload._onFileProgress({target:e(a,i.upload.wrapper)},100),i.upload._onUploadSuccess({target:e(a,i.upload.wrapper)},t,n),i.cleanupFileEntry(a)):(i.upload._onFileProgress({target:e(a,i.upload.wrapper)},100),i._resetChunkIndex(l),i.upload._onUploadSuccess({target:e(a,i.upload.wrapper)},t,n),i.performUpload(a.next())):(i._increaseChunkIndex(l),i.performUpload(a)))}),o):o()},onRequestError:function(t,a){var n=t.target;this.upload._onUploadError({target:e(a,this.upload.wrapper)},n)},cleanupFileEntry:function(t){var a=t.data("relatedInput"),n=!0;a&&(e.each(a.data("relatedFileEntries")||[],(function(){this.parent().length>0&&this[0]!=t[0]&&(n=n&&this.hasClass("k-file-success"))})),n&&a.remove())},removeFileEntry:function(e){var t=this.upload.options.async.chunkSize,a=this.upload.options.async.concurrent,n=this.upload.wrapper.find(".k-upload-selected").length>0;this.cleanupFileEntry(e),!t||a||n||e.next().length&&this.performUpload(e.next()),this.upload._removeFileEntry(e)},onRequestProgress:function(t,a){var n,i=Math.round(100*t.loaded/t.total),o=a.data("uid");this.upload.options.async.chunkSize&&(i=(n=this.metaData[o])&&n.totalChunks?Math.round(n.chunkIndex/n.totalChunks*100):100),this.upload._onFileProgress({target:e(a,this.upload.wrapper)},i)},stopUploadRequest:function(e){e.data("request")&&e.data("request").abort()},prepareChunk:function(e){var t=e.data("files")[0],a=t.rawFile,n=t.uid,i=this.upload.options.async.chunkSize;this.position[n]=0,this.metaData[n]={chunkIndex:0,contentType:a.type,fileName:a.name,relativePath:t.name,totalFileSize:a.size,totalChunks:Math.ceil(a.size/i),uploadUid:n}},_decreaseChunkIndex:function(e){this.metaData[e].chunkIndex--},_increaseChunkIndex:function(e){this.metaData[e].chunkIndex++},_resetChunkIndex:function(e){this.metaData[e].chunkIndex=0},_decreasePosition:function(e){this.position[e]-=this.upload.options.async.chunkSize},_getCurrentChunk:function(e,t){var a,n=this.position[t],i=this.upload.options.async,o=i.chunkSize||i.bufferChunkSize;return this.position[t]||(this.position[t]=0),this.position[t]+=o,(a=this._getChunker(e))?e[a](n,this.position[t]):e},_getChunker:function(e){return e.slice?"slice":e.mozSlice?"mozSlice":e.webkitSlice?"webkitSlice":null}},a.ui.plugin(D)}(window.kendo.jQuery),kendo}));
//# sourceMappingURL=kendo.upload.min.js.map
